{
	"name": "SQL _Load_Data_From_Blob_Union",
	"properties": {
		"content": {
			"query": "-- Check the available database names\n--SELECT name, database_id, create_date  \n--FROM sys.databases;  \n--GO\n\n-- Change the databse collesion\n--alter database [default]\n--COLLATE Latin1_General_100_BIN2_UTF8;\n\n-- Main queries Inside CTE's to read data from CSV files from the ADLS\n;with cte_AMR_08 as (\nSELECT \n    Trekkingsdatum\n    ,CAST(Peildatum as DATE) as Peildatum\n    ,Markt\n    ,CAST(Leveringsadres_Postcode as INT) as Leveringsadres_Postcode\n    ,Leveringsadres_Gemeente\n    --,Sector,Graaddagen_RM,Graaddagen_VM_2017--,Perc_Delta_VM_2017vsRM,Graaddagen_VM_2018--,Perc_Delta_VM_2018vsRM,Graaddagen_VM_2019\n    --,Perc_Delta_VM_2019vsRM,Graaddagen_VM_2020--,Perc_Delta_VM_2020vsRM,Graaddagen_VM_2021--,Perc_Delta_VM_2021vsRM\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2017\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2018\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2019\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2020\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2021   \n    ,(CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_WerkelijkVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as Total_AantalToegangspunten\n    ,'Analogue' as MeasurementType\nFROM\n    OPENROWSET(\n        BULK 'https://wendydlstorage.blob.core.windows.net/data/Bronze Layer/2022_08/P6523_Verbruiken_AMR_GEMEENTE_202208.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        DELIMITER = ';',\n        HEADER_ROW = TRUE\n    ) AS [result]\n)\n,cte_DM_08 as (\nSELECT \n    Trekkingsdatum\n    ,CAST(Peildatum as DATE) as Peildatum\n    ,Markt\n    --,LP_Aanwezig,UNT_Aanwezig,SociaalTarief_Aanwezig,KlantFluvius,Graaddagen_RM,Graaddagen_VM_2017,Perc_Delta_VM_2017vsRM,Graaddagen_VM_2018,Perc_Delta_VM_2018vsRM,Graaddagen_VM_2019,Perc_Delta_VM_2019vsRM,Graaddagen_VM_2020,Perc_Delta_VM_2020vsRM,Graaddagen_VM_2021,Perc_Delta_VM_2021vsRM\n    ,CAST(Leveringsadres_Postcode as INT) as Leveringsadres_Postcode\n    ,Leveringsadres_Gemeente\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2017\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2018\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2019\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2020\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2021   \n    ,(CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_WerkelijkVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as Total_AantalToegangspunten\n    ,'Digital' as MeasurementType\n\nFROM\n    OPENROWSET(\n        BULK 'https://wendydlstorage.blob.core.windows.net/data/Bronze Layer/2022_08/P6523_Verbruiken_DM_GEMEENTE_202208.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        DELIMITER = ';',\n        HEADER_ROW = TRUE\n    ) AS [result]\n)\n,cte_AMR_09 as (\nSELECT \n    Trekkingsdatum\n    ,CAST(Peildatum as DATE) as Peildatum\n    ,Markt\n    ,CAST(Leveringsadres_Postcode as INT) as Leveringsadres_Postcode\n    ,Leveringsadres_Gemeente\n    --,Sector,Graaddagen_RM,Graaddagen_VM_2017--,Perc_Delta_VM_2017vsRM,Graaddagen_VM_2018--,Perc_Delta_VM_2018vsRM,Graaddagen_VM_2019\n    --,Perc_Delta_VM_2019vsRM,Graaddagen_VM_2020--,Perc_Delta_VM_2020vsRM,Graaddagen_VM_2021--,Perc_Delta_VM_2021vsRM\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2017\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2018\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2019\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2020\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2021   \n    ,(CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_WerkelijkVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as Total_AantalToegangspunten\n    ,'Analogue' as MeasurementType\nFROM\n    OPENROWSET(\n        BULK 'https://wendydlstorage.blob.core.windows.net/data/Bronze Layer/2022_09/P6523_Verbruiken_AMR_GEMEENTE_202209.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        DELIMITER = ';',\n        HEADER_ROW = TRUE\n    ) AS [result]\n)\n,cte_DM_09 as (\nSELECT \n    Trekkingsdatum\n    ,CAST(Peildatum as DATE) as Peildatum\n    ,Markt\n    --,LP_Aanwezig,UNT_Aanwezig,SociaalTarief_Aanwezig,KlantFluvius,Graaddagen_RM,Graaddagen_VM_2017,Perc_Delta_VM_2017vsRM,Graaddagen_VM_2018,Perc_Delta_VM_2018vsRM,Graaddagen_VM_2019,Perc_Delta_VM_2019vsRM,Graaddagen_VM_2020,Perc_Delta_VM_2020vsRM,Graaddagen_VM_2021,Perc_Delta_VM_2021vsRM\n    ,CAST(Leveringsadres_Postcode as INT) as Leveringsadres_Postcode\n    ,Leveringsadres_Gemeente\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2017\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2018\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2019\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2020\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2021   \n    ,(CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_WerkelijkVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as Total_AantalToegangspunten\n    ,'Digital' as MeasurementType\n\nFROM\n    OPENROWSET(\n        BULK 'https://wendydlstorage.blob.core.windows.net/data/Bronze Layer/2022_09/P6523_Verbruiken_DM_GEMEENTE_202209.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        DELIMITER = ';',\n        HEADER_ROW = TRUE\n    ) AS [result]\n)\n,cte_AMR_10 as (\nSELECT \n    Trekkingsdatum\n    ,CAST(Peildatum as DATE) as Peildatum\n    ,Markt\n    ,CAST(Leveringsadres_Postcode as INT) as Leveringsadres_Postcode\n    ,Leveringsadres_Gemeente\n    --,Sector,Graaddagen_RM,Graaddagen_VM_2017--,Perc_Delta_VM_2017vsRM,Graaddagen_VM_2018--,Perc_Delta_VM_2018vsRM,Graaddagen_VM_2019\n    --,Perc_Delta_VM_2019vsRM,Graaddagen_VM_2020--,Perc_Delta_VM_2020vsRM,Graaddagen_VM_2021--,Perc_Delta_VM_2021vsRM\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2017\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2018\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2019\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2020\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2021   \n    ,(CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_WerkelijkVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as Total_AantalToegangspunten\n    ,'Analogue' as MeasurementType\nFROM\n    OPENROWSET(\n        BULK 'https://wendydlstorage.blob.core.windows.net/data/Bronze Layer/2022_10/P6523_Verbruiken_AMR_GEMEENTE_202210.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        DELIMITER = ';',\n        HEADER_ROW = TRUE\n    ) AS [result]\n)\n,cte_DM_10 as (\nSELECT \n    Trekkingsdatum\n    ,CAST(Peildatum as DATE) as Peildatum\n    ,Markt\n    --,LP_Aanwezig,UNT_Aanwezig,SociaalTarief_Aanwezig,KlantFluvius,Graaddagen_RM,Graaddagen_VM_2017,Perc_Delta_VM_2017vsRM,Graaddagen_VM_2018,Perc_Delta_VM_2018vsRM,Graaddagen_VM_2019,Perc_Delta_VM_2019vsRM,Graaddagen_VM_2020,Perc_Delta_VM_2020vsRM,Graaddagen_VM_2021,Perc_Delta_VM_2021vsRM\n    ,CAST(Leveringsadres_Postcode as INT) as Leveringsadres_Postcode\n    ,Leveringsadres_Gemeente\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2017\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2018\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2019\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2020\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2021   \n    ,(CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_WerkelijkVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as Total_AantalToegangspunten\n    ,'Digital' as MeasurementType\n\nFROM\n    OPENROWSET(\n        BULK 'https://wendydlstorage.blob.core.windows.net/data/Bronze Layer/2022_10/P6523_Verbruiken_DM_GEMEENTE_202210.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        DELIMITER = ';',\n        HEADER_ROW = TRUE\n    ) AS [result]\n)\n,cte_AMR_11 as (\nSELECT \n    Trekkingsdatum\n    ,CAST(Peildatum as DATE) as Peildatum\n    ,Markt\n    ,CAST(Leveringsadres_Postcode as INT) as Leveringsadres_Postcode\n    ,Leveringsadres_Gemeente\n    --,Sector,Graaddagen_RM,Graaddagen_VM_2017--,Perc_Delta_VM_2017vsRM,Graaddagen_VM_2018--,Perc_Delta_VM_2018vsRM,Graaddagen_VM_2019\n    --,Perc_Delta_VM_2019vsRM,Graaddagen_VM_2020--,Perc_Delta_VM_2020vsRM,Graaddagen_VM_2021--,Perc_Delta_VM_2021vsRM\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2017\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2018\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2019\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2020\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2021   \n    ,(CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_WerkelijkVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as Total_AantalToegangspunten\n    ,'Analogue' as MeasurementType\nFROM\n    OPENROWSET(\n        BULK 'https://wendydlstorage.blob.core.windows.net/data/Bronze Layer/2022_11/P6523_Verbruiken_AMR_GEMEENTE_202211.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        DELIMITER = ';',\n        HEADER_ROW = TRUE\n    ) AS [result]\n)\n,cte_DM_11 as (\nSELECT \n    Trekkingsdatum\n    ,CAST(Peildatum as DATE) as Peildatum\n    ,Markt\n    --,LP_Aanwezig,UNT_Aanwezig,SociaalTarief_Aanwezig,KlantFluvius,Graaddagen_RM,Graaddagen_VM_2017,Perc_Delta_VM_2017vsRM,Graaddagen_VM_2018,Perc_Delta_VM_2018vsRM,Graaddagen_VM_2019,Perc_Delta_VM_2019vsRM,Graaddagen_VM_2020,Perc_Delta_VM_2020vsRM,Graaddagen_VM_2021,Perc_Delta_VM_2021vsRM\n    ,CAST(Leveringsadres_Postcode as INT) as Leveringsadres_Postcode\n    ,Leveringsadres_Gemeente\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2017_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2017\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2018_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2018\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2019_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2019\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2020_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2020\n    ,CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)) as WerkelijkVerbruik_RM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021\n    ,CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)) as BenaderendVerbruik_VM_2021_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as AantalToegangspunten_2021   \n    ,(CAST(REPLACE(WerkelijkVerbruik_RM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(WerkelijkVerbruik_RM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_WerkelijkVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik\n    ,(CAST(REPLACE(BenaderendVerbruik_VM_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(BenaderendVerbruik_VM_2021,',','.') as DECIMAL(16,4)))/5 as Gemiddeld_BenaderendVerbruik_Norm\n    ,CAST(REPLACE(AantalToegangspunten_2017,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2018,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2019,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2020,',','.') as DECIMAL(16,4))+CAST(REPLACE(AantalToegangspunten_2021,',','.') as DECIMAL(16,4)) as Total_AantalToegangspunten\n    ,'Digital' as MeasurementType\n\nFROM\n    OPENROWSET(\n        BULK 'https://wendydlstorage.blob.core.windows.net/data/Bronze Layer/2022_11/P6523_Verbruiken_DM_GEMEENTE_202211.csv',\n        FORMAT = 'CSV',\n        PARSER_VERSION = '2.0',\n        DELIMITER = ';',\n        HEADER_ROW = TRUE\n    ) AS [result]\n)\n,CTE_UNION_AMR as (\n    SELECT * FROM cte_AMR_08 UNION\n    SELECT * FROM cte_AMR_09 UNION\n    SELECT * FROM cte_AMR_10 UNION\n    SELECT * FROM cte_AMR_11\n)\n,CTE_UNION_DM as (\n    SELECT * FROM cte_DM_08 UNION\n    SELECT * FROM cte_DM_09 UNION\n    SELECT * FROM cte_DM_10 UNION\n    SELECT * FROM cte_DM_11\n)\n,CTE_UNION_ALL as (\n    SELECT * FROM CTE_UNION_AMR UNION\n    SELECT * FROM CTE_UNION_DM\n)\n\nSelect * \nFROM CTE_UNION_ALL;\n\n",
			"metadata": {
				"language": "sql"
			},
			"currentConnection": {
				"databaseName": "master",
				"poolName": "Built-in"
			},
			"resultLimit": 5000
		},
		"type": "SqlQuery"
	}
}